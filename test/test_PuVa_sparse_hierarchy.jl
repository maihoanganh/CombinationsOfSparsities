include("./CombinationsOfSparsities.jl")
using .CombinationsOfSparsities

using DynamicPolynomials

@time begin
eps=1e-5
k=1 # relaxed order

@polyvar x1 x2 x3 # variables
x=[x1;x2;x3]

f=Array{Any}(undef, 2)
f[1]=x1*x2
f[2]=x2*x3

f0=f[1]+f[2]
g=[1-x1^2-x2^2;
   1-x2^2-x3^2]
h=[x2*x3-1/2]



I=Array{Any}(undef, 2)
I[1]=[1;2]
I[2]=[2;3]

J=Array{Any}(undef, 2)
J[1]=[1]
J[2]=[2]

W=Array{Any}(undef, 2)
W[1]=[]
W[2]=[1]

opt_val, sol = CombinationsOfSparsities.PuVa_sparse_hierarchy(x,f0,g,h,I,J,W,eps,k)
end

"""
Termination status = OPTIMAL
Optimal value = 7.999305000097095e-5
====================================
Atom(I[1]):
====================================

Rank of moment matrix = 2
------------------------------------
atom 1 = Any[0.7071247202133244, -0.7071282978118933]
check lower bound  = 0
check inequality 1 = -5.579950311807025e-5
####################################
Solution = Any[0.7071247202133244, -0.7071282978118933]
####################################
------------------------------------
atom 2 = Any[-0.7071247202133292, 0.7071282978118947]
check lower bound  = 0
check inequality 1 = -5.579950312650794e-5
####################################
Solution = Any[-0.7071247202133292, 0.7071282978118947]
####################################
====================================
Atom(I[2]):
====================================
Rank of moment matrix = 2
------------------------------------
atom 1 = Any[-0.7071076365899291, -0.7071220841876198]
check lower bound  = 0
check inequality 1 = -2.285166963833518e-5
check equality 1 = 1.1425730452763183e-5
####################################
Solution = Any[-0.7071076365899291, -0.7071220841876198]
####################################
------------------------------------
atom 2 = Any[0.707107636589932, 0.7071220841876305]
check lower bound  = 0
check inequality 1 = -2.2851669657653062e-5
check equality 1 = 1.1425730462311101e-5
####################################
Solution = Any[0.707107636589932, 0.7071220841876305]
####################################
  9.074698 seconds (3.21 M allocations: 305.171 MiB, 2.34% gc time)
(7.999305000097095e-5, Any[[0.7071247202133244 -0.7071247202133292; -0.7071282978118933 0.7071282978118947], [-0.7071076365899291 0.707107636589932; -0.7071220841876198 0.7071220841876305]])
"""