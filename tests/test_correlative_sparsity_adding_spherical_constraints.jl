include("./CombinationsOfSparsities.jl")
using .CombinationsOfSparsities

using DynamicPolynomials

@time begin
eps=1e-2
k=2 # relaxed order

@polyvar x1 x2 x3 # variables
x=[x1;x2;x3]

g=[1-x1^2-x2^2]
h=[x2*x3-1/2]



I=Array{Any}(undef, 2)
I[1]=[1;2]
I[2]=[2;3]

J=Array{Any}(undef, 2)
J[1]=[1]
J[2]=[]

W=Array{Any}(undef, 2)
W[1]=[]
W[2]=[1]

sol = CombinationsOfSparsities.correlative_sparsity_adding_spherical_constraints(x,g,h,I,J,W,eps,k)
end


"""
Determine L0:
------------------------------------
Termination status = OPTIMAL
Optimal value = 1.0623938452654818
====================================
Atom(I[1]):
====================================
Rank of moment matrix = 2
------------------------------------
atom 1 = Any[5.499106512180634e-13, -0.7021205450150616]
check lower bound  = 0
check inequality 1 = 0.5070267402677529
####################################
Solution = Any[5.499106512180634e-13, -0.7021205450150616]
####################################
------------------------------------
atom 2 = Any[3.179880197361038e-13, 0.7021205450170027]
check lower bound  = 0
check inequality 1 = 0.507026740265027
####################################
Solution = Any[3.179880197361038e-13, 0.7021205450170027]
####################################
====================================
Atom(I[2]):
====================================
Rank of moment matrix = 4
------------------------------------
L0 = 1.0623938452654818
====================================
Determine omega0[1]:
------------------------------------
Termination status = OPTIMAL
Optimal value = 0.3518364689988381
====================================
Atom(I[1]):
====================================
Rank of moment matrix = 2
------------------------------------
atom 1 = Any[-4.573532794930582e-17, 0.5931759093612777]
check lower bound  = 0
check inequality 1 = 0.6481423405534212
check inequality 2 = 0.710536185818903
####################################
Solution = Any[-4.573532794930582e-17, 0.5931759093612777]
####################################
------------------------------------
atom 2 = Any[-1.3209543076017487e-16, -0.5931759093612777]
check lower bound  = 0
check inequality 1 = 0.6481423405534212
check inequality 2 = 0.710536185818903
####################################
Solution = Any[-1.3209543076017487e-16, -0.5931759093612777]
####################################
====================================
Atom(I[2]):
====================================
Rank of moment matrix = 2
------------------------------------
atom 1 = Any[-0.5931867938729981, -0.8429742535146173]
check lower bound  = 0
check inequality 1 = -8.231924837120985e-5
check equality 1 = 4.119475981978482e-5
####################################
Solution = Any[-0.5931867938729981, -0.8429742535146173]
####################################
------------------------------------
atom 2 = Any[0.5931867938729982, 0.8429742535146173]
check lower bound  = 0
check inequality 1 = -8.23192483714319e-5
check equality 1 = 4.119475981978482e-5
####################################
Solution = Any[0.5931867938729982, 0.8429742535146173]
####################################
------------------------------------
omega0[1] = 0.3518364689988381
====================================
 32.307978 seconds (7.60 M allocations: 6.682 GiB, 3.76% gc time)
2-element Array{Any,1}:
 [-4.573532794930582e-17 -1.3209543076017487e-16; 0.5931759093612777 -0.5931759093612777]
 [-0.5931867938729981 0.5931867938729982; -0.8429742535146173 0.8429742535146173]        
"""